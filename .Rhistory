library(tidyverse)
library(readr)
astrocyte_wt_ad_count_matrix <- read_csv('/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz')
read_csv('/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz')
read_csv('/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz')
library(Seurat)
library(tidyverse)
library(readr)
library(Seurat)
library(tidyverse)
library(readr)
library(Seurat)
library(tidyverse)
library(readr)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", row.names = 1)
View(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz")
View(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", row.names = 1)
ad_wt_astro <- CreatSeuratObject(raw.data = data)
ad_wt_astro <- CreateSeuratObject(raw.data = data)
View(data)
View(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", row.names = 1)
View(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz")
View(data)
ad_wt_astro <- CreateSeuratObject(raw.data = data)
ad_wt_astro <- CreateSeuratObject(data)
ad_wt_astro <- CreateSeuratObject(as.matrix(data))
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", row.names = 1)
View(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz")
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", row.names = 1,
check.names = FALSE)
View(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", row.names = 0,
check.names = FALSE)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", row.names = 1,
check.names = FALSE)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz")
dim(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", header=TRUE, row.names = 1)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", header=TRUE, row.names = 1)
dim(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv.gz", header=TRUE)
View(data)
data <- read.csv("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv")
View(data)
data <- read_delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", delim = ';')
```{r}
library(Seurat)
library(tidyverse)
library(readr)
data <- read_delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", delim = ';')
dim(data)
View(data)
CreateSeuratObject(data)
ad_wt_astro <- CreateSeuratObject(data)
data <- read_delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", delim = ';', row.names=1)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", delim = ';', row.names = 1)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", delim = ';', row.names = 1)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", sep = ';', row.names = 1)
ad_wt_astro <- CreateSeuratObject(data)
ad_wt_astro <- CreateSeuratObject(data)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", sep = ';', row.names = 1)
ad_wt_astro <- CreateSeuratObject(data)
ad_wt_astro[["percent.mt"]] <- PercentageFeatureSet(ad_wt_astro, pattern = "^MT-")
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0)
library(tidyverse)
```
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", sep = ';', row.names = 1)
ad_wt_astro <- CreateSeuratObject(data)
ad_wt_astro <- CreateSeuratObject(data)
ad_wt_astro <- CreateSeurateObject(data)
library(Seurat)
library(tidyverse)
library(readr)
ad_wt_astro <- CreateSeurateObject(data)
ad_wt_astro <- CreateSeurateObject(data)
ad_wt_astro <- CreateSeuratObject(data)
ad_wt_astro[["percent.mt"]] <- PercentageFeatureSet(ad_wt_astro, pattern = "^MT-")
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
View(ad_wt_astro)
View(data)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, points = 0)
library(Seurat)
library(tidyverse)
library(readr)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, points = 0)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0.1)
ad_wt_astro <- subset(ad_wt_astro, subset = nFeature_RNA > 400 && percent.mt < 5)
ad_wt_astro <- subset(ad_wt_astro, subset = nFeature_RNA > 400 & percent.mt < 5)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", sep = ';', row.names = 1)
all_data_umi <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = ' ', row.names = 1)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
library(Seurat)
library(tidyverse)
library(readr)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, n.points = 0)
?VlnPlot
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0)
View(ad_wt_astro)
?CreateSeuratObject
ad_wt_astro.metadata
ad_wt_astro@metadata
ad_wt_astro$metadata
metadata <- ad_wt_astro@meta.data
metadata
head(rownames(seurat_object))
head(rownames(ad_wt_astro))
x <- rownames(ad_wt_astro)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0)
View(metadata)
View(metadata)
ad_wt_astro[["percent.mt"]] <- PercentageFeatureSet(ad_wt_astro, pattern = "^mt-")
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0)
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0.1)
metadata <- ad_wt_astro@meta.data
metadata
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0.1)
View(ad_wt_astro)
View(data)
library(Seurat)
library(tidyverse)
library(readr)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", sep = ';', row.names = 1)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", sep = ';', row.names = 1)
ad_wt_astro <- CreateSeuratObject(data)
ad_wt_astro[["percent.mt"]] <- PercentageFeatureSet(ad_wt_astro, pattern = "^mt-")
ad_wt_astro[["percent.mt"]] <- PercentageFeatureSet(ad_wt_astro, pattern = "^mt-")
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0.1)
?VlnPlot
?CreateSeuratObject
metadata <- ad_wt_astro@meta.data
metadata
x <- rownames(ad_wt_astro)
# Paper used a filtering metric of > 400 detected genes,
# I will manually calculate the outlier values for the Feature RNA,
# and use a value between 3 - 5 outliers for the nCount_RNA and n_Feature_RNA
# It is possible I am removing biological signal, but I will
plot1 <- FeatureScatter(ad_wt_astro, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(ad_wt_astro, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
# Visualize QC metrics as a violin plot
VlnPlot(ad_wt_astro, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3, pt.size = 0)
View(metadata)
ad_wt_astro <- subset(ad_wt_astro, subset = nFeature_RNA > 200 & nFeature_RNA < 1500 & percent.mt < 5)
ad_wt_astro <- NormalizeData(ad_wt_astro, normalization.method = "LogNormalize", scale.factor = 10000)
View(metadata)
View(metadata)
rownames(ad_wt_astro)
View(data)
View(metadata)
rownames(metadata)
View(metadata)
View(metadata)
cell_names <- colnames(AD_CT_Astrocytes)
cell_names_and_condition <- rownames(AD_CT_Astrocytes)
ad_wt_astro <- NormalizeData(ad_wt_astro, normalization.method = "LogNormalize", scale.factor = 10000)
cell_names_and_con <- rownames(ad_wt_astro)
cell_names_and_con <- rownames(metadata)
library(DESeq2)
library(Seurat)
library(tidyverse)
library(readr)
library(stringr)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = ';', row.names = 1)
View(data)
View(data)
library(DESeq2)
library(Seurat)
library(tidyverse)
library(readr)
library(stringr)
library(fread)
install.packags(fread)
install.packages(fread)
library(data.table)
library(DESeq2)
library(Seurat)
library(tidyverse)
library(readr)
library(stringr)
library(fread)
library(data.table)
library(DESeq2)
library(Seurat)
library(tidyverse)
library(readr)
library(stringr)
data <- fread("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt",
sep = ";",
header = TRUE,
data.table = FALSE) # Returns a data.frame like read.delim
library(data.table)
data <- fread("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt",
sep = ";",
header = TRUE,
quote = "",      # Fixes the "invalid quotes" error
data.table = FALSE)
# Set row names (Gene names are in the first column)
rownames(data) <- data[[1]]
data <- data[,-1]
View(data)
ad_wt_astro <- CreateSeuratObject(data)
# Use sep = "\t" for tabs and quote = "\"" to handle the double quotes
data <- fread("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt",
sep = "\t",
header = TRUE,
quote = "\"",
data.table = FALSE)
# Set the first column (Gene names) as row names
rownames(data) <- data[[1]]
data <- data[,-1]
View(data)
ad_wt_astro <- CreateSeuratObject(data)
library(Matrix)
library(Seurat)
# 1. Convert to sparse matrix directly
sparse_counts <- as(as.matrix(your_data_frame), "dgCMatrix")
library(Matrix)
library(Seurat)
# 1. Convert to sparse matrix directly
sparse_counts <- as(as.matrix(data), "dgCMatrix")
library(Matrix)
library(Seurat)
# 1. Read the data (use read.csv or data.table::fread)
data <- read.csv("GSE143758_Admouse_Hippocampus_3TimeCourses_Astrocytes_WT_AD_Aging.csv", row.names = 1)
library(Matrix)
library(Seurat)
# 1. Read the data (use read.csv or data.table::fread)
data <- fread("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt",
sep = "\t",
header = TRUE,
quote = "\"",
data.table = FALSE)
# 2. Convert to sparse matrix WITHOUT creating a dense intermediate
# Note: if it's already a data frame, as.matrix is often still called internally.
# Try converting column by column if it still fails:
counts_sparse <- Matrix(as.matrix(data), sparse = TRUE)
library(data.table)
library(DESeq2)
library(Seurat)
library(tidyverse)
library(readr)
library(stringr)
library(Matrix)
# 1. Read the data
data <- fread("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt",
sep = "\t", header = TRUE, data.table = FALSE)
# 1.5. SET ROWNAMES BEFORE CONVERSION
rownames(data) <- data[[1]]
data <- data[,-1]
# 2. Convert to sparse matrix
counts_sparse <- Matrix(as.matrix(data), sparse = TRUE)
sessionInfo()
data <- read.table("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_3TimeCourses_Astrocytes_WT_AD_Aging.csv", sep = ';', row.names = 1)
data <- read.table("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_3TimeCourses_Astrocytes_WT_AD_Aging.csv", sep = ';', row.names = 1)
View(data)
AD_WT_astrocyte <- CreateSeuratObject(counts = data)
library(Seurat)
library(tidyverse)
AD_WT_astrocyte <- CreateSeuratObject(counts = data)
data <- read.delim("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_3TimeCourses_Astrocytes_WT_AD_Aging.csv", sep = ';', row.names = TRUE)
View(data)
AD_WT_astrocyte <- CreateSeuratObject(counts = data)
data <- read.delim("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_3TimeCourses_Astrocytes_WT_AD_Aging.csv", sep = ';')
View(data)
AD_WT_astrocyte <- CreateSeuratObject(counts = data)
data <- as.matrix(fread("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_3TimeCourses_Astrocytes_WT_AD_Aging.csv", sep = ';'), rownames=1)
library(Seurat)
library(tidyverse)
library(readr)
data <- as.matrix(fread("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_3TimeCourses_Astrocytes_WT_AD_Aging.csv", sep = ';'), rownames=1)
library(Seurat)
library(tidyverse)
library(readr)
data <- read.delim("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_3TimeCourses_Astrocytes_WT_AD_Aging.csv", sep = ';', row.names = 1)
AD_WT_astrocyte <- CreateSeuratObject(data)
AD_WT_astrocyte@meta.data
AD_WT_astrocyte <- CreateSeuratObject(data)
AD_WT_astrocyte@meta.data <- tibble::rownames_to_column((AD_WT_astrocyte@meta.data), "complete_id")
AD_WT_astrocyte@meta.data
AD_WT_astrocyte@meta.data <- separate_wider_delim(AD_WT_astrocyte@meta.data,
delim = '_',
names = c("batch_id", "sample_id", "umi"))
?separate_wider_delim
AD_WT_astrocyte@meta.data <- separate_wider_delim(AD_WT_astrocyte@meta.data,
delim = '_',
complete_id,
names = c("batch_id", "sample_id", "umi"))
View(data)
View(AD_WT_astrocyte)
View(data)
View(data)
unique(AD_WT_astrocyte@orig.ident)
unique(AD_WT_astrocyte@meta.data(orig.ident))
AD_WT_astrocyte@meta.data
AD_WT_astrocyte@meta.data['orig.ident']
unique(AD_WT_astrocyte@meta.data['orig.ident'])
AD_WT_astrocyte@meta.data
unique(AD_WT_astrocyte@meta.data['orig.ident'])
AD_WT_astrocyte@meta.data
unique(AD_WT_astrocyte@meta.data['orig.ident'])
AD_WT_astrocyte@meta.data
unique(AD_WT_astrocyte@meta.data['orig.ident'])
AD_WT_astrocyte@meta.data
unique(AD_WT_astrocyte@meta.data['complete_id'])
ids < - unique(AD_WT_astrocyte@meta.data['complete_id'])
ids < - AD_WT_astrocyte@meta.data['complete_id']
AD_WT_astrocyte@meta.data['complete_id']
series <- AD_WT_astrocyte@meta.data['complete_id']
series <- AD_WT_astrocyte@meta.data['complete_id']
View(series)
View(series)
library(seurat)
library(Seurat)
data = rea.delim("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
data = read.delim("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
```{r}
counts <- CreateSeuratObject(data)
counts@meta.data
unique(counts@meta.data['orig.ident'])
counts@meta.data <- tibble::rownames_to_column((AD_WT_astrocyte@meta.data), "complete_id")
counts@meta.data <- tibble::rownames_to_column((counts@meta.data), "complete_id")
counts@meta.data
series <- counts@meta.data['complete_id']
View(series)
library(tidyverse)
counts <- CreateSeuratObject(data)
counts@meta.data <- tibble::rownames_to_column((counts@meta.data), "complete_id")
library(Seurat)
library(tidyverse)
data = read.delim("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
counts <- CreateSeuratObject(data)
counts@meta.data <- tibble::rownames_to_column((counts@meta.data), "complete_id")
counts@meta.data
counts@meta.data %>% separate_wider_delim(complete_id, delim = "_", names = c("batch", "sample_id", "UMI"))
counts@meta.data
counts@meta.data <-separate_wider_delim(complete_id, delim = "_", names = c("batch", "sample_id", "UMI"))
counts@meta.data <- separate_wider_delim(complete_id, delim = "_", names = c("batch", "sample_id", "UMI"))
counts@meta.data
counts@meta.data <- separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI"))
counts@meta.data
counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI"))
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI"))
counts@meta.data
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI", cols_remove = FALSE))
counts@meta.data <- tibble::rownames_to_column((counts@meta.data), "complete_id")
counts@meta.data
library(Seurat)
library(tidyverse)
data = read.delim("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
counts <- CreateSeuratObject(data)
counts@meta.data <- tibble::rownames_to_column((counts@meta.data), "complete_id")
counts@meta.data
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI", cols_remove = FALSE))
counts@meta.data <- tibble::rownames_to_column((counts@meta.data), "complete_id")
counts@meta.data
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI", "complete_id" cols_remove = FALSE))
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI"), cols_remove = FALSE))
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI"), cols_remove = FALSE)
counts@meta.data
unique(counts@meta.data['sample_id'])
counts@meta.data
(counts@meta.data)$lysis =
counts@meta.data %>% separate_wider_delim('batch', delim = ".", names = c("Lysis", "Batch_num"), cols_remove = FALSE)
(counts@meta.data)$lysis =
counts@meta.data %>% separate_wider_delim('batch', delim = ".", names = c("Lysis", "Batch_num"), cols_remove = FALSE)
unique(counts@meta.data['sample_id'])
counts@meta.data %>% separate_wider_delim('batch', delim = ".", names = c("Lysis", "Batch_num"), cols_remove = FALSE)
counts@meta.data %>% separate_wider_delim('batch', delim = ".", names = c("Lysis", "Batch_num"), cols_remove = TRUE)
counts@meta.data <- counts@meta.data %>% separate_wider_delim('batch', delim = ".", names = c("Lysis", "Batch_num"), cols_remove = TRUE)
unique(counts@meta.data['sample_id'])
unique(counts@meta.data['Lysis'])
unique(counts@meta.data['Batch_num'])
unique(counts@meta.data['sample_id'])
counts@meta.data
complete_ids <- counts@meta.data['complete_id']
View(complete_ids)
unique(counts@meta.data['Batch_num'])
unique(counts@meta.data['sample_id'])
counts@meta.data
counts@meta.data
library(Seurat)
library(tidyverse)
data = fread("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
library(data.table)
data = fread("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
View(data)
View(data)
counts <- CreateSeuratObject(data)
library(Seurat)
library(tidyverse)
library(data.table)
data = read.csv("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
library(Seurat)
library(tidyverse)
library(data.table)
library(Seurat)
library(tidyverse)
library(data.table)
data = read.csv("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
counts <- CreateSeuratObject(data)
# Source - https://stackoverflow.com/a
# Posted by user2554330
# Retrieved 2025-12-24, License - CC BY-SA 4.0
# Save an object to a file
saveRDS(object, file = "CLEAN_ANALYSIS.rds")
# Source - https://stackoverflow.com/a
# Posted by user2554330
# Retrieved 2025-12-24, License - CC BY-SA 4.0
# Save an object to a file
saveRDS(counts, file = "CLEAN_ANALYSIS.rds")
library(vroom)
library(Seurat)
library(tidyverse)
library(data.table)
library(vroom)
data = vroom("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep = "\t")
data = vroom("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt")
View(data)
counts <- CreateSeuratObject(data)
library(Seurat)
library(tidyverse)
library(data.table)
library(vroom)
data = read.csv("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt", sep='\t')
counts <- CreateSeuratObject(data)
counts@meta.data <- tibble::rownames_to_column((counts@meta.data), "complete_id")
counts@meta.data <- tibble::rownames_to_column((counts@meta.data), "complete_id")
counts@meta.data
SaveSeuratRds(
counts
)
LoadSeuratRds(counts)
LoadSeuratRds(file = counts)
SaveSeuratRds(
counts,
file = "counts.Rds"
)
LoadSeuratRds(file = counts.Rds)
LoadSeuratRds(file = '/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Code_and_writeup/Single_Cell_Astrocyte_Project/counts.Rds')
LoadSeuratRds(file = '/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Code_and_writeup/Single_Cell_Astrocyte_Project/counts.Rds')
counts <- LoadSeuratRds(file = '/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Code_and_writeup/Single_Cell_Astrocyte_Project/counts.Rds')
View(counts)
View(counts)
library(Seurat)
library(tidyverse)
library(data.table)
library(vroom)
counts <- LoadSeuratRds(file = '/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Code_and_writeup/Single_Cell_Astrocyte_Project/counts.Rds')
View(counts)
counts@meta.data
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI"), cols_remove = FALSE)
unique(counts@meta.data['sample_id'])
counts@meta.data <- counts@meta.data %>% separate_wider_delim('batch', delim = ".", names = c("Lysis", "Batch_num"), cols_remove = TRUE)
complete_ids <- counts@meta.data['complete_id']
unique(counts@meta.data['Batch_num'])
counts@meta.data %>%
select()
counts[["percent.mt"]] <- PercentageFeatureSet(counts, pattern = "^mt-")
View(complete_ids)
View(counts)
counts@meta.data[["percent.mt"]] <- PercentageFeatureSet(counts, pattern = "^mt-")
counts@meta.data
counts[["percent.mt"]] <- PercentageFeatureSet(counts, pattern = "^mt-")
head(colnames(pbmc))
head(colnames(coutns))
head(colnames(counts))
head(rownames(counts@meta.data))
head(colnames(counts))
head(rownames(counts@meta.data))
head(colnames(counts))
head(colnames(counts))
head(rownames(counts@meta.data))
counts[["percent.mt"]] <- PercentageFeatureSet(counts, pattern = "^mt-")
counts <- LoadSeuratRds(file = '/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Code_and_writeup/Single_Cell_Astrocyte_Project/counts.Rds')
counts[["percent.mt"]] <- PercentageFeatureSet(counts, pattern = "^mt-")
counts@meta.data
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI"), cols_remove = FALSE)
counts@meta.data <- counts@meta.data %>% separate_wider_delim('complete_id', delim = "_", names = c("batch", "sample_id", "UMI"), cols_remove = FALSE)
library(Seurat)
library(tidyverse)
library(data.table)
library(vroom)
data = vroom('/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE143758_Admouse_Hippocampus_7m_AllNuclei_UMIcounts.txt')
counts <- CreateSeuratObject(data)
