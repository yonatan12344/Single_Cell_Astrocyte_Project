library(dplyr)
library(ggplot2)
library(data.table)
library(Seurat)
AD_WT_DATA <- read.csv('/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_counts.csv', header=TRUE, row.names = 1)
cell_metadata <- read.csv("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_covariates.csv", header=TRUE, row.names = 1)
seurat_data <-  CreateSeuratObject(counts = AD_WT_DATA, meta.data = cell_metadata)
seurat_data[["percent.mt"]] <- PercentageFeatureSet(seurat_data, pattern = "^MT-")
head(seurat_data@meta.data, 5)
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
seurat_data <- NormalizeData(seurat_data, normalization.method = "LogNormalize", scale.factor = 10000)
#AD_CT_Astrocytes <- subset(seurat_data, subset="oupSample.celltype" == "astro" )
AD_CT_Astrocytes <- seurat_data[ , rownames(seurat_data@meta.data)[seurat_data@meta.data$oupSample.cellType == 'astro']]
# 1. Get the full list of cell barcodes (row names/column names)
cell_names <- colnames(AD_CT_Astrocytes)
# 2. Split each barcode by the underscore and keep the LAST element
# This separates the UMI from the Sample ID.
sample_ids <- sapply(
X = strsplit(cell_names, split = "_"),
FUN = function(x) {
tail(x, 1) # Gets the last element after splitting
}
)
clean_batch_astrocytes <- subset(AD_CT_Astrocytes, subset = '')
AddMetaData(AD_CT_Astrocytes, sample_ids)
AddMetaData(AD_CT_Astrocytes, sample_ids, col.name = "Batch_name")
clean_batch_AD_CT_astro <- subset(AD_CT_Astrocytes, subset = "Batch_name" != "AD8" & "Batch_name" != "Ct8")
AddMetaData(AD_CT_Astrocytes, sample_ids, col.name = "Batch_name")
clean_batch_AD_CT_astro <- subset(AD_CT_Astrocytes, subset = "Batch_name" != "AD8" & "Batch_name" != "Ct8")
AD_CT_Astrocytes <- AddMetaData(AD_CT_Astrocytes, sample_ids, col.name = "Batch_name")
AD_CT_Astrocytes <- AddMetaData(AD_CT_Astrocytes, sample_ids, col.name = "Batch_name")
clean_batch_AD_CT_astro <- subset(AD_CT_Astrocytes, subset = "Batch_name" != "AD8" & "Batch_name" != "Ct8")
clean_batch_AD_CT_astro <- subset(AD_CT_Astrocytes, subset = "Batch_name" != "AD8" & "Batch_name" != "Ct8")
AD_CT_Astrocytes <- AddMetaData(AD_CT_Astrocytes, sample_ids, col.name = "Batch_name")
View(AD_CT_Astrocytes)
head(clean_batch_AD_CT_astro@meta.data, 5)
head(AD_CT_Astrocytes@meta.data, 5)
clean_batch_AD_CT_astro <- subset(AD_CT_Astrocytes, subset = Batch_name != "AD8" & Batch_name != "Ct8")
head(AD_CT_Astrocytes@meta.data, 5)
View(clean_batch_AD_CT_astro)
View(AD_CT_Astrocytes)
View(clean_batch_AD_CT_astro)
clean_batch_AD_CT_astro <- subset(AD_CT_Astrocytes, subset = Batch_name != AD8 & Batch_name != Ct8)
clean_batch_AD_CT_astro <- subset(AD_CT_Astrocytes, subset = Batch_name != "AD8" & Batch_name != "Ct8")
head(AD_CT_Astrocytes@meta.data, 5)
unique(AD_CT_Astrocytes@meta.data$Batch_name)
View(cell_metadata)
head(AD_CT_Astrocytes@meta.data, 5)
View(AD_WT_DATA)
View(cell_metadata)
View(AD_WT_DATA)
library(dplyr)
library(ggplot2)
library(data.table)
library(Seurat)
library(rstatix)
AD_WT_DATA <- read.csv('/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_counts.csv', header=TRUE, row.names = 1)
cell_metadata <- read.csv("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_covariates.csv", header=TRUE, row.names = 1)
seurat_data <-  CreateSeuratObject(counts = AD_WT_DATA, meta.data = cell_metadata)
seurat_data[["percent.mt"]] <- PercentageFeatureSet(seurat_data, pattern = "^MT-")
head(seurat_data@meta.data, 5)
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", group.by=seurat_data@orig.ident)
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", group.by=seurat_data@oupSample.cellType)
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", group.by= oupSample.cellType)
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", group.by= 'oupSample.cellType')
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", cells = 'astro')
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
astro_cells <- WhichCells(seurat_data, idents = 'astro')
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
Idents(seurat_data)
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
Idents(seurat_data)
RegroupIdents(seurat_data, oupSample.cellType)
RegroupIdents(seurat_data, oupSample.cellType)
RegroupIdents(seurat_data, seurat_data@oupSample.cellType)
RegroupIdents(seurat_data, metadata = 'oupSample.cellType')
Idents(seurat_data)
seurat_data <- RegroupIdents(seurat_data, metadata = 'oupSample.cellType')
Idents(seurat_data)
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", cells = 'astro')
seurat_data <- RegroupIdents(seurat_data, metadata = 'oupSample.cellType')
Idents(seurat_data)
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", cells = 'astro')
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", idents = 'astro')
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", Idents = 'astro')
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", cells = 'astro')
seurat_data <- RegroupIdents(seurat_data, metadata = 'oupSample.cellType')
Idents(seurat_data)
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", cells = 'astro')
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt", idents = 'astro')
astro_seurat <- subset(seurat_data, idents = "astro")
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
astro_seurat <- seurat_data[ , rownames(seurat_data@meta.data)[seurat_data@meta.data$oupSample.cellType == 'astro']]
plot1 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA"plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA"plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
astro_seurat <- seurat_data[ , rownames(seurat_data@meta.data)[seurat_data@meta.data$oupSample.cellType == 'astro']]
plot1 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA"plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA"plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
astro_seurat <- seurat_data[ , rownames(seurat_data@meta.data)[seurat_data@meta.data$oupSample.cellType == 'astro']]
plot1 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
plot2 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
astro_seurat <- seurat_data[ , rownames(seurat_data@meta.data)[seurat_data@meta.data$oupSample.cellType == 'astro']]
plot1 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
astro_seurat <- seurat_data[ , rownames(seurat_data@meta.data)[seurat_data@meta.data$oupSample.cellType == 'astro']]
plot1 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
Idents(astro_seurat) <- astro_seurat$oupSample.cellType
plot1 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(astro_seurat, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
library('seurat')
library(seurat)
library(Seurat)
library(tidyverse)
install.packages("tidyverse")
