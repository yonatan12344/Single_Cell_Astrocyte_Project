library(dplyr)
library(ggplot2)
library(data.table)
library(Seurat)
AD_WT_DATA <- read.csv('/home/yonatan/Desktop/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_counts.csv', header=TRUE, row.names = 1)
cell_metadata <- read.csv("/home/yonatan/Desktop/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_covariates.csv", header=TRUE, row.names = 1)
seurat_data <-  CreateSeuratObject(counts = AD_WT_DATA, meta.data = cell_metadata)
library(dplyr)
library(ggplot2)
library(data.table)
library(Seurat)
AD_WT_DATA <- read.csv('/home/yonatan/Desktop/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_counts.csv', header=TRUE, row.names = 1)
AD_WT_DATA <- read.csv('AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_counts.csv', header=TRUE, row.names = 1)
AD_WT_DATA <- read.csv('/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_counts.csv', header=TRUE, row.names = 1)
library(dplyr)
library(ggplot2)
library(data.table)
library(Seurat)
AD_WT_DATA <- read.csv('/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_counts.csv', header=TRUE, row.names = 1)
cell_metadata <- read.csv("/Users/yonatan/Desktop/Single_Cell_Proj/AQP4_snRNA_project/AQP4_Expression_snRNA_seq/Data/GSE138852_covariates.csv", header=TRUE, row.names = 1)
seurat_data <-  CreateSeuratObject(counts = AD_WT_DATA, meta.data = cell_metadata)
seurat_data[["percent.mt"]] <- PercentageFeatureSet(seurat_data, pattern = "^MT-")
head(seurat_data@meta.data, 5)
# Visualize QC metrics as a violin plot
VlnPlot(seurat_data, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
# FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.
plot1 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(seurat_data, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
seurat_data <- NormalizeData(seurat_data, normalization.method = "LogNormalize", scale.factor = 10000)
seurat_data <- NormalizeData(seurat_data, normalization.method = "LogNormalize", scale.factor = 10000)
#AD_CT_Astrocytes <- subset(seurat_data, subset="oupSample.celltype" == "astro" )
AD_CT_Astrocytes <- seurat_data[ , rownames(seurat_data@meta.data)[seurat_data@meta.data$oupSample.cellType == 'astro']]
# 1. Get the full list of cell barcodes (row names/column names)
cell_names <- colnames(AD_CT_Astrocytes)
# 2. Split each barcode by the underscore and keep the LAST element
# This separates the UMI from the Sample ID.
sample_ids <- sapply(
X = strsplit(cell_names, split = "_"),
FUN = function(x) {
tail(x, 1) # Gets the last element after splitting
}
)
clean_batch_astrocytes <- subset(AD_CT_Astrocytes, subset = '')
metadata <- ad_wt_astro@meta.data
metadata
library(Seurat)
library(tidyverse)
library(readr)
data <- read.delim("/Users/yonatan/Desktop/single_cell_AD_WT_mice_data/GSE143758_Admouse_Crtx_7-10m_Astrocytes_UMIcounts.csv", sep = ';', row.names = 1)
install.packages("scCustomize")
install.packages("BiocManager")
BiocManager::install(c("ComplexHeatmap", "dittoSeq", "DropletUtils", "Nebulosa"))
